<turbo-frame id="ranking_list" class="block space-y-10 pt-2">
  <div class="space-y-10">
  <!-- 1. Hall of Fame (Podium) -->
  <section class="space-y-6">
    <div class="text-center space-y-1">
      <h3 class="text-xs font-black text-indigo-400 uppercase tracking-[0.3em]">μ΄λ‹¬μ ν†µν•© μ„±μ·¨ λ­ν‚Ή</h3>
      <p class="text-[10px] font-bold text-slate-500">λ¨λ‘κ°€ ν•¨κ» κ²½μν•κ³  μ„±μ¥ν•λ” λ…μμ μ „λ‹Ή</p>
    </div>

    <!-- Podium Visual -->
    <div class="relative h-60 flex items-end justify-center gap-2 px-4">
      <!-- Top 2 -->
      <div class="flex flex-col items-center gap-3 w-24">
        <%= link_to prototype_user_card_path(@top_users[1]&.id || 0), data: { turbo_frame: "user-profile-modal-frame" }, class: "group contents" do %>
          <div class="relative">
            <div class="w-16 h-16 rounded-full border-4 border-slate-400 overflow-hidden shadow-2xl group-active:scale-95 transition-transform">
              <img src="<%= @top_users[1]&.profile_image %>" class="w-full h-full object-cover">
            </div>
            <div class="absolute -top-2 -right-2 w-7 h-7 bg-slate-400 rounded-full flex items-center justify-center text-white font-black border-2 border-[#0C0B12] text-xs shadow-lg">2</div>
          </div>
          <div class="w-full h-24 bg-slate-800/40 rounded-t-[20px] border border-white/5 flex flex-col items-center justify-center group-hover:bg-slate-800/60 transition-colors">
             <p class="text-[11px] font-black text-white line-clamp-1"><%= @top_users[1]&.nickname %></p>
             <div class="flex items-center gap-1 mt-0.5">
               <% if @monthly_rankings[1]&.dig(:is_club) %>
                 <span class="px-2 py-0.5 rounded-full bg-indigo-500 text-[8px] font-black text-white">λ£¨ν</span>
               <% end %>
               <p class="text-[9px] font-bold text-slate-500"><%= @monthly_rankings[1]&.dig(:score)&.round(1) || 0 %>P</p>
             </div>
          </div>
        <% end %>
      </div>

      <!-- Top 1 (Center) -->
      <div class="flex flex-col items-center gap-3 w-28 -translate-y-4">
        <%= link_to prototype_user_card_path(@top_users[0]&.id || 0), data: { turbo_frame: "user-profile-modal-frame" }, class: "group contents" do %>
          <div class="relative">
            <div class="absolute inset-0 bg-indigo-500 blur-2xl opacity-40 animate-pulse"></div>
            <div class="relative w-20 h-20 rounded-full border-4 border-amber-400 overflow-hidden shadow-2xl group-active:scale-95 transition-transform">
              <img src="<%= @top_users[0]&.profile_image %>" class="w-full h-full object-cover">
            </div>
            <div class="absolute -top-3 -right-3 w-9 h-9 bg-amber-400 rounded-full flex items-center justify-center text-white font-black border-4 border-[#0C0B12] text-sm shadow-xl">π‘‘</div>
          </div>
          <div class="w-full h-32 bg-indigo-500/10 rounded-t-[20px] border border-indigo-500/30 flex flex-col items-center justify-center shadow-[0_0_20px_rgba(124,77,255,0.2)] group-hover:bg-indigo-500/20 transition-colors">
             <p class="text-sm font-black text-white line-clamp-1"><%= @top_users[0]&.nickname %></p>
             <div class="flex items-center gap-1 mt-1">
                <% if @monthly_rankings[0]&.dig(:is_club) %>
                  <span class="px-2 py-0.5 rounded-full bg-indigo-500 text-[8px] font-black text-white">
                    λ£¨ν
                  </span>
                <% end %>
               <p class="text-[10px] font-bold text-indigo-400"><%= @monthly_rankings[0]&.dig(:score)&.round(1) || 0 %>P</p>
             </div>
          </div>
        <% end %>
      </div>

      <!-- Top 3 -->
      <div class="flex flex-col items-center gap-3 w-24">
        <%= link_to prototype_user_card_path(@top_users[2]&.id || 0), data: { turbo_frame: "user-profile-modal-frame" }, class: "group contents" do %>
          <div class="relative">
            <div class="w-16 h-16 rounded-full border-4 border-amber-700/50 overflow-hidden shadow-2xl group-active:scale-95 transition-transform">
              <img src="<%= @top_users[2]&.profile_image %>" class="w-full h-full object-cover">
            </div>
            <div class="absolute -top-2 -right-2 w-7 h-7 bg-amber-700/80 rounded-full flex items-center justify-center text-white font-black border-2 border-[#0C0B12] text-xs shadow-lg">3</div>
          </div>
          <div class="w-full h-20 bg-slate-800/20 rounded-t-[20px] border border-white/5 flex flex-col items-center justify-center group-hover:bg-slate-800/40 transition-colors">
             <p class="text-[11px] font-black text-white line-clamp-1"><%= @top_users[2]&.nickname %></p>
             <div class="flex items-center gap-1 mt-0.5">
               <% if @monthly_rankings[2]&.dig(:is_club) %>
                 <span class="px-2 py-0.5 rounded-full bg-indigo-500 text-[8px] font-black text-white">λ£¨ν</span>
               <% end %>
               <p class="text-[9px] font-bold text-slate-500"><%= @monthly_rankings[2]&.dig(:score)&.round(1) || 0 %>P</p>
             </div>
          </div>
        <% end %>
      </div>
    </div>
  </section>

  <!-- 1.5 Integrated Leaderboard Table -->
  <section class="space-y-4">
    <div class="flex justify-between items-center px-2">
      <h3 class="text-xs font-black text-slate-500 uppercase tracking-[0.2em]">π† λ¦¬λ”λ³΄λ“</h3>
      <div class="flex items-center gap-2">
        <button type="button" 
                onclick="document.getElementById('score-guide-modal').classList.remove('hidden')"
                class="px-2 py-0.5 bg-indigo-500/10 rounded-full flex items-center gap-1 hover:bg-indigo-500/20 transition-colors">
          <span class="text-[8px] font-black text-indigo-400">ν¬μΈνΈ κΈ°μ¤€</span>
          <svg class="w-2.5 h-2.5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
        </button>
        <p class="text-[10px] font-bold text-indigo-400"><%= Date.current.strftime('%Yλ…„ %mμ›”') %></p>
      </div>
    </div>

    <!-- Ranking List Partial (Turbo Frame is inside the partial) -->
    <%= render partial: "ranking_list", locals: { rankings: @monthly_rankings, period: @period || 'monthly' } %>
  </section>

  <!-- Full Ranking Modal -->
  <div id="full-ranking-modal" class="hidden fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-0 sm:p-4">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="this.parentElement.classList.add('hidden')"></div>
    <div class="relative w-full max-w-lg h-[90vh] sm:h-[80vh] bg-[#0C0B12] rounded-t-[40px] sm:rounded-[40px] border-t sm:border border-white/10 flex flex-col overflow-hidden animate-slide-up">
      <!-- Modal Header -->
      <div class="sticky top-0 z-20 bg-[#0C0B12] p-6 border-b border-white/5">
        <div class="flex justify-between items-center mb-4">
          <h4 class="text-lg font-black text-white">μ „μ²΄ ν†µν•© λ¦¬λ”λ³΄λ“</h4>
          <button onclick="this.closest('#full-ranking-modal').classList.add('hidden')" class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-slate-400">β•</button>
        </div>
        <div class="flex items-center gap-2">
          <% if @my_ranking %>
            <div class="flex-1 p-4 bg-indigo-600/20 border border-indigo-500/30 rounded-2xl flex items-center justify-between">
              <div class="flex items-center gap-3">
                <span class="text-xs font-black text-indigo-400">#<%= @my_ranking[:rank] %></span>
                <span class="text-[11px] font-bold text-white"><%= current_user.nickname %>λ‹ (λ‚)</span>
              </div>
              <span class="text-xs font-black text-indigo-400"><%= @my_ranking[:score] %>P</span>
            </div>
          <% end %>
        </div>
      </div>

      <!-- Modal Body -->
      <div class="flex-1 overflow-y-auto p-4 space-y-2 pb-[160px]">
        <% @monthly_rankings.each_with_index do |ranking, index| %>
          <% user = ranking[:user] %>
          <%= link_to prototype_user_card_path(user), data: { turbo_frame: "user-profile-modal-frame" }, class: "flex items-center justify-between p-4 #{user == current_user ? 'bg-indigo-600/10 border border-indigo-500/20' : 'bg-white/[0.03]'} rounded-2xl hover:bg-white/[0.08] transition-colors" do %>
            <div class="flex items-center gap-4">
              <div class="w-6 text-center text-[10px] font-black <%= index < 3 ? 'text-amber-400' : 'text-slate-500' %>"><%= index + 1 %></div>
              <div class="w-8 h-8 rounded-lg overflow-hidden shrink-0">
                <img src="<%= user.profile_image %>" class="w-full h-full object-cover">
              </div>
              <div>
                <div class="flex items-center gap-1.5">
                  <span class="text-xs font-black text-white line-clamp-1"><%= user.nickname %></span>
                  <% if ranking[:is_club] %>
                    <span class="text-[8px]">π”±</span>
                  <% end %>
                </div>
                <p class="text-[8px] font-bold text-slate-500">Lv.<%= user.level %></p>
              </div>
            </div>
            <p class="text-xs font-bold text-white"><%= ranking[:score] %>P</p>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Score Guide Modal -->
  <div id="score-guide-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-6">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="this.parentElement.classList.add('hidden')"></div>
    <div class="relative w-full max-w-sm bg-[#1B1A24] rounded-[32px] border border-white/10 p-8 animate-badge-pop shadow-2xl">
      <div class="flex justify-between items-start mb-6">
        <div>
          <h3 class="text-xl font-black text-white mb-1">π† λ­ν‚Ή ν¬μΈνΈ κΈ°μ¤€</h3>
          <p class="text-[10px] font-bold text-slate-500">ν™λ™μ— λ”°λΌ μ μκ°€ μλ™μΌλ΅ μ§‘κ³„λ©λ‹λ‹¤.</p>
        </div>
        <button onclick="this.closest('#score-guide-modal').classList.add('hidden')" class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-slate-400 hover:text-white hover:bg-white/10 transition-colors">β•</button>
      </div>
      
      <div class="space-y-3">
        <div class="flex justify-between items-center p-3 rounded-xl bg-white/5 border border-white/5">
          <div class="flex items-center gap-3">
            <span class="text-lg">β”οΈ</span>
            <span class="text-xs font-bold text-white">λ£¨ν‹΄ 1ν μ™„λ£</span>
          </div>
          <span class="text-xs font-black text-indigo-400">+10 P</span>
        </div>
        <div class="flex justify-between items-center p-3 rounded-xl bg-white/5 border border-white/5">
          <div class="flex items-center gap-3">
            <span class="text-lg">π“</span>
            <span class="text-xs font-bold text-white">μ¤λμ ν™•μ–Έ μ‘μ„±</span>
          </div>
          <span class="text-xs font-black text-indigo-400">+5 P</span>
        </div>
        <div class="flex justify-between items-center p-3 rounded-xl bg-white/5 border border-white/5">
          <div class="flex items-center gap-3">
            <span class="text-lg">π”¥</span>
            <span class="text-xs font-bold text-white">λΌμ΄λΈλ£Έ μ°Έμ—¬</span>
          </div>
          <span class="text-xs font-black text-indigo-400">+20 P</span>
        </div>
        <div class="flex justify-between items-center p-3 rounded-xl bg-white/5 border border-white/5">
          <div class="flex items-center gap-3">
            <span class="text-lg">π©</span>
            <span class="text-xs font-bold text-white">μ±λ¦°μ§€/λ¨μ„ κ°μ„¤</span>
          </div>
          <span class="text-xs font-black text-indigo-400">+60 P</span>
        </div>
        <div class="flex justify-between items-center p-3 rounded-xl bg-white/5 border border-white/5">
          <div class="flex items-center gap-3">
            <span class="text-lg">πƒ</span>
            <span class="text-xs font-bold text-white">μ±λ¦°μ§€/λ¨μ„ μ°Έμ—¬</span>
          </div>
          <span class="text-xs font-black text-indigo-400">+30 P</span>
        </div>
      </div>

      <div class="mt-6">
        <button onclick="document.getElementById('point-detail-modal').classList.remove('hidden')" 
                class="w-full py-4 bg-indigo-500/10 hover:bg-indigo-500/20 border border-indigo-500/30 rounded-2xl text-[11px] font-black text-indigo-400 transition-all flex items-center justify-center gap-2 group">
          <span>μ‹μ¤ν… μƒμ„Έ κ°€μ΄λ“ λ³΄κΈ°</span>
          <svg class="w-3 h-3 group-hover:translate-x-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M13 7l5 5m0 0l-5 5m5-5H6"/></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Detailed Point Guide Modal -->
  <div id="point-detail-modal" class="hidden fixed inset-0 z-[110] flex items-center justify-center p-6">
    <div class="absolute inset-0 bg-black/95 backdrop-blur-xl" onclick="this.parentElement.classList.add('hidden')"></div>
    <div class="relative w-full max-w-sm h-[80vh] bg-[#0C0B12] rounded-[40px] border border-white/20 flex flex-col overflow-hidden animate-slide-up">
      <!-- Header -->
      <div class="p-8 pb-4 flex justify-between items-center shrink-0">
        <div>
          <h4 class="text-xl font-black text-white">ν¬μΈνΈ μ‹μ¤ν… κ°€μ΄λ“</h4>
          <p class="text-[10px] font-bold text-slate-500 mt-1 uppercase tracking-widest">Mastering the Routine System</p>
        </div>
        <button onclick="this.closest('#point-detail-modal').classList.add('hidden')" class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-slate-400">β•</button>
      </div>

      <!-- Content -->
      <div class="flex-1 overflow-y-auto p-8 pt-2 space-y-8 custom-scrollbar">
        <!-- Intro Message (Moved to Top) -->
        <div class="p-6 bg-indigo-500/10 border border-indigo-500/20 rounded-[28px] text-center space-y-1.5">
           <p class="text-[11px] font-black text-white leading-relaxed">λ£¨ν ν΄λ½μ€ μ„±μ‹¤ν•¨μ„ λ³΄μƒν•λ” κµ¬μ΅°λ΅ μ΄μλ©λ‹λ‹¤.</p>
           <p class="text-[10px] font-bold text-slate-400 leading-relaxed">μ μ ν• λ£¨ν‹΄ κ°μλ΅ κΎΈμ¤€ν μ‹¤μ²ν•λ” μ μ €κ°€<br/>κ°€μ¥ λ†’κ² ν‰κ°€λ©λ‹λ‹¤.</p>
        </div>

        <!-- 1. Platform Level -->
        <div class="space-y-4">
          <div class="flex items-center gap-2">
            <span class="w-1.5 h-1.5 rounded-full bg-indigo-500"></span>
            <h5 class="text-xs font-black text-indigo-400 uppercase tracking-widest">1. ν”λ«νΌ λ λ²¨ μ μ</h5>
          </div>
          <div class="p-5 bg-white/[0.03] border border-white/5 rounded-3xl space-y-3">
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-slate-400">λ£¨ν‹΄ μ™„λ£ (1νλ‹Ή)</span>
               <span class="text-white">+10P</span>
             </div>
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-slate-400">μ¤λμ ν™•μ–Έ μ‘μ„±</span>
               <span class="text-white">+5P</span>
             </div>
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-slate-400">λΌμ΄λΈ μ„Έμ… μ°Έμ—¬</span>
               <span class="text-white">+20P</span>
             </div>
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-slate-400">λ¨μ„/μ±λ¦°μ§€ κ°μ„¤</span>
               <span class="text-white">+60P</span>
             </div>
          </div>
        </div>

        <!-- 2. Club Growth Points -->
        <div class="space-y-4">
          <div class="flex items-center gap-2">
            <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
            <h5 class="text-xs font-black text-emerald-400 uppercase tracking-widest">2. λ£¨ν ν΄λ½ μ„±μ¥ ν¬μΈνΈ</h5>
          </div>
          <div class="p-5 bg-emerald-500/[0.02] border border-emerald-500/10 rounded-3xl space-y-3">
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-slate-400">κΈ°λ³Έ μ¶μ„</span>
               <span class="text-white">+10P</span>
             </div>
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-emerald-400">λ£¨ν‹΄ 100% μ™„μ λ³΄λ„μ¤</span>
               <span class="text-emerald-400">+30P</span>
             </div>
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-slate-400">λ£¨ν‹΄ 50% μ΄μƒ μ‹¤μ² λ³΄λ„μ¤</span>
               <span class="text-white">+5P</span>
             </div>
             <div class="flex justify-between items-center text-[11px] font-bold">
               <span class="text-amber-400">7μΌ μ—°μ† μ™„μ (κ³¨λ“  νμ΄μ–΄)</span>
               <span class="text-amber-400">+50P</span>
             </div>
          </div>
        </div>

        <!-- 3. Growth Identity -->
        <div class="space-y-4">
          <div class="flex items-center gap-2">
            <span class="w-1.5 h-1.5 rounded-full bg-slate-500"></span>
            <h5 class="text-xs font-black text-slate-500 uppercase tracking-widest">3. μ„±μ¥ μ •μ²΄μ„± λ“±κΈ‰</h5>
          </div>
          <div class="grid grid-cols-1 gap-2">
             <div class="p-4 rounded-2xl bg-indigo-600/20 border border-indigo-500/30 flex justify-between items-center">
               <div class="flex items-center gap-2">
                 <span class="text-xs">π”±</span>
                 <span class="text-[11px] font-black text-white">μ§„ν™”λ λ΅λ“ λ§μ¤ν„°</span>
               </div>
               <span class="text-[10px] font-bold text-indigo-400">Top 15%</span>
             </div>
             <div class="p-4 rounded-2xl bg-white/[0.03] border border-white/5 flex justify-between items-center">
               <span class="text-[11px] font-black text-white pl-6">μ •μ§„ν•λ” κ°€μ΄λ“</span>
               <span class="text-[10px] font-bold text-slate-500">λ‹¬μ„± 70%β†‘</span>
             </div>
             <div class="p-4 rounded-2xl bg-white/[0.03] border border-white/5 flex justify-between items-center">
               <span class="text-[11px] font-black text-white pl-6">μ„±μ¥μ κ°μ²™μ</span>
               <span class="text-[10px] font-bold text-slate-500">λ‹¬μ„± 40%β†‘</span>
             </div>
          </div>
        </div>

        <!-- 4. Strategic Core Tips -->
        <div class="space-y-4 pb-12">
          <div class="flex items-center gap-2">
            <span class="w-1.5 h-1.5 rounded-full bg-amber-500"></span>
            <h5 class="text-xs font-black text-amber-500 uppercase tracking-widest">π’΅ κ³ λ“μ μ„ μ„ν• ν•µμ‹¬ ν</h5>
          </div>
          <div class="space-y-3">
             <div class="flex gap-3">
               <span class="text-xs shrink-0">π―</span>
               <p class="text-[11px] font-bold text-slate-400 leading-relaxed">λ£¨ν‹΄ κ°μλ¥Ό λλ¦¬λ©΄ <strong class="text-white">ν”λ«νΌ λ λ²¨</strong>μ΄ λΉ λ¥΄κ² μ¤λ¥΄μ§€λ§, <strong class="text-white">ν΄λ½ λ³΄λ„μ¤ μ μ</strong>λ¥Ό λ°›κΈ°λ” λ” μ–΄λ ¤μ›μ§‘λ‹λ‹¤.</p>
             </div>
             <div class="flex gap-3">
               <span class="text-xs shrink-0">β–οΈ</span>
               <p class="text-[11px] font-bold text-slate-400 leading-relaxed">ν΄λ½ λ­ν‚Ήμ—μ„ μ λ¦¬ν•λ ¤λ©΄ λ‚μ—κ² <strong class="text-white">κ°€μ¥ μ¤‘μ”ν• λ£¨ν‹΄ 3~5κ°</strong>λ¥Ό ν™•μ‹¤ν•κ² μ™„μν•λ” κ²ƒμ΄ κ°€μ¥ μ¤λ§νΈν• μ „λµμ…λ‹λ‹¤.</p>
             </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  </style>


  </div>
</turbo-frame>

