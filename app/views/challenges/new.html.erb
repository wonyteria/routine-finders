<% is_gathering = @challenge.offline? %>

<div class="max-w-3xl mx-auto py-12 pb-32">
  <div class="flex items-center gap-4 mb-10">
    <h1 class="text-3xl font-black text-slate-900"><%= is_gathering ? '오프라인 모임 개최' : '온라인 챌린지 개최' %></h1>
  </div>

  <%= form_with model: @challenge, local: true, class: "bg-white rounded-[40px] border border-slate-200 p-10 shadow-sm space-y-8" do |f| %>
    <%= f.hidden_field :mode, value: @challenge.mode %>

    <!-- Basic Info -->
    <div class="space-y-8">
      <h2 class="text-xl font-black text-slate-900 flex items-center gap-2">
        <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
        기본 정보 입력
      </h2>

      <div class="space-y-2">
        <%= f.label :title, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>제목<% end %>
        <%= f.text_field :title, placeholder: is_gathering ? "예: 강남역 독서 벙개" : "예: 매일 아침 6시 기상", class: "w-full bg-slate-50 border-none rounded-2xl p-5 text-lg font-bold focus:ring-2 focus:ring-indigo-500" %>
      </div>

      <div class="space-y-2">
        <%= f.label :summary, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>한 줄 소개<% end %>
        <%= f.text_field :summary, placeholder: "목표를 한 문장으로 표현하세요", class: "w-full bg-slate-50 border-none rounded-2xl p-5 font-medium focus:ring-2 focus:ring-indigo-500" %>
      </div>

      <div class="space-y-2">
        <%= f.label :description, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>상세 설명<% end %>
        <%= f.text_area :description, placeholder: "챌린지에 대한 자세한 설명을 적어주세요", rows: 4, class: "w-full bg-slate-50 border-none rounded-[24px] p-6 font-medium focus:ring-2 focus:ring-indigo-500" %>
      </div>

      <div class="space-y-2">
        <%= f.label :category, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>카테고리<% end %>
        <div class="flex gap-2 flex-wrap">
          <% %w[Health Study Work Hobby Life Mind Fun].each do |cat| %>
            <label class="cursor-pointer">
              <%= f.radio_button :category, cat, class: "hidden peer" %>
              <span class="px-6 py-2 rounded-full text-xs font-black border-2 transition-all peer-checked:bg-indigo-600 peer-checked:border-indigo-600 peer-checked:text-white bg-white border-slate-100 text-slate-400 hover:border-indigo-300">
                <%= cat %>
              </span>
            </label>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Meeting Info (Offline only) -->
    <% if is_gathering %>
      <%= f.fields_for :meeting_info do |mf| %>
        <div class="space-y-8 pt-8 border-t border-slate-100">
          <h2 class="text-xl font-black text-slate-900 flex items-center gap-2">
            <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657 13.414 20.9a1.998 1.998 0 0 1-2.827 0l-4.244-4.243a8 8 0 1 1 11.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/></svg>
            모임 정보 설정
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <%= mf.label :place_name, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>장소명<% end %>
              <%= mf.text_field :place_name, placeholder: "예: 스타벅스 강남점", class: "w-full bg-slate-50 border-none rounded-2xl p-5 font-bold focus:ring-2 focus:ring-indigo-500" %>
            </div>
            <div class="space-y-2">
              <%= mf.label :meeting_time, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>모임 시간<% end %>
              <%= mf.text_field :meeting_time, placeholder: "예: 토요일 09:00", class: "w-full bg-slate-50 border-none rounded-2xl p-5 font-bold focus:ring-2 focus:ring-indigo-500" %>
            </div>
          </div>

          <div class="space-y-2">
            <%= mf.label :address, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>상세 주소<% end %>
            <%= mf.text_field :address, placeholder: "지번 또는 도로명 주소 입력", class: "w-full bg-slate-50 border-none rounded-2xl p-5 font-bold focus:ring-2 focus:ring-indigo-500" %>
          </div>

          <div class="space-y-2">
            <%= mf.label :description, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>모임 가이드<% end %>
            <%= mf.text_area :description, placeholder: "참여자들이 찾아오기 쉽게 설명을 적어주세요.", rows: 3, class: "w-full bg-slate-50 border-none rounded-[24px] p-6 font-medium focus:ring-2 focus:ring-indigo-500" %>
          </div>
        </div>
      <% end %>
    <% end %>

    <!-- Deposit Settings -->
    <div class="space-y-8 pt-8 border-t border-slate-100">
      <h2 class="text-xl font-black text-slate-900 flex items-center gap-2">
        <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/></svg>
        보증금 설정
      </h2>

      <div class="space-y-2">
        <%= f.label :amount, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>금액 설정<% end %>
        <div class="flex items-center gap-4">
          <%= f.number_field :amount, value: is_gathering ? 30000 : 10000, class: "flex-1 bg-slate-50 border-none rounded-2xl p-5 text-xl font-black focus:ring-2 focus:ring-indigo-500" %>
          <span class="text-xl font-black text-slate-900">원</span>
        </div>
      </div>

      <div class="p-6 bg-slate-50 rounded-3xl border border-slate-100 flex items-start gap-3">
        <svg class="w-5 h-5 text-indigo-600 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        <p class="text-xs font-bold text-slate-500 leading-relaxed">
          보증금은 참여 의지를 확인하는 장치입니다.
          <%= is_gathering ? ' 모임 불참 시 페널티 규칙에 따라 정산됩니다.' : ' 미인증 시 차감되며 정해진 규칙에 따라 환급됩니다.' %>
        </p>
      </div>
    </div>

    <!-- Date Settings -->
    <div class="space-y-8 pt-8 border-t border-slate-100">
      <h2 class="text-xl font-black text-slate-900 flex items-center gap-2">
        <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
        기간 설정
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-2">
          <%= f.label :start_date, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>시작일<% end %>
          <%= f.date_field :start_date, value: Date.current, class: "w-full bg-slate-50 border-none rounded-2xl p-5 font-bold focus:ring-2 focus:ring-indigo-500" %>
        </div>
        <div class="space-y-2">
          <%= f.label :end_date, class: "text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1" do %>종료일<% end %>
          <%= f.date_field :end_date, value: is_gathering ? Date.current : Date.current + 30.days, class: "w-full bg-slate-50 border-none rounded-2xl p-5 font-bold focus:ring-2 focus:ring-indigo-500" %>
        </div>
      </div>
    </div>

    <!-- Submit -->
    <div class="pt-10">
      <%= f.submit "개최 완료하기", class: "w-full py-6 bg-indigo-600 text-white rounded-2xl font-black text-xl shadow-xl hover:bg-indigo-700 transition-all cursor-pointer" %>
    </div>
  <% end %>
</div>
