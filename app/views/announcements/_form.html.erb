<% parent = challenge || routine_club %>
<% is_prototype = params[:source] == "prototype" %>

<%= form_with model: [parent, announcement], local: true, 
              class: "#{is_prototype ? 'app-glass-card p-5 md:p-8 space-y-6 md:space-y-7 border-none' : 'bg-white rounded-[40px] border border-slate-200 p-10 shadow-sm space-y-8'}",
              data: { controller: "announcement-form" } do |f| %>
  <%= hidden_field_tag :source, "prototype" if is_prototype %>
  
  <% if announcement.errors.any? %>
    <div class="p-4 bg-rose-500/10 rounded-2xl border border-rose-500/20">
      <p class="text-[10px] font-black text-rose-500 uppercase tracking-widest leading-loose">
        <%= announcement.errors.full_messages.join(". ") %>
      </p>
    </div>
  <% end %>

  <div class="space-y-5 md:space-y-6">
    <div class="space-y-2">
      <label class="text-[9px] font-black <%= is_prototype ? 'text-slate-500' : 'text-slate-400' %> uppercase tracking-widest pl-1">공지 제목</label>
      <%= f.text_field :title, 
                       placeholder: "공지 제목", 
                       required: true,
                       class: "w-full #{is_prototype ? 'bg-white/5 border-white/10 text-white font-black italic text-base md:text-lg focus:border-indigo-500' : 'bg-slate-50 border-none text-lg font-bold focus:ring-2 focus:ring-indigo-500'} rounded-2xl md:rounded-[20px] p-3.5 md:p-5 outline-none transition-all placeholder:text-slate-600" %>
    </div>

    <div class="space-y-2">
      <label class="text-[9px] font-black <%= is_prototype ? 'text-slate-500' : 'text-slate-400' %> uppercase tracking-widest pl-1">공지 내용</label>
      <%= f.text_area :content, 
                       placeholder: "상세 내용을 입력하세요...", 
                       rows: 6, 
                       class: "w-full #{is_prototype ? 'bg-white/5 border-white/10 text-slate-300 font-medium text-xs md:text-sm focus:border-indigo-500' : 'bg-slate-50 border-none text-slate-600 font-medium focus:ring-2 focus:ring-indigo-500'} rounded-[20px] md:rounded-[24px] p-4 md:p-6 outline-none transition-all placeholder:text-slate-700" %>
    </div>
  </div>

  <div class="p-4 md:p-6 <%= is_prototype ? 'bg-white/5 border-white/5' : 'bg-slate-50 border-slate-100' %> rounded-2xl md:rounded-[28px] border flex items-center gap-3">
    <div class="w-6 h-6 rounded-lg <%= is_prototype ? 'bg-indigo-500/20 text-indigo-400' : 'bg-indigo-100 text-indigo-600' %> flex items-center justify-center flex-shrink-0">
      <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
    </div>
    <p class="text-[9px] md:text-[10px] font-black <%= is_prototype ? 'text-slate-500' : 'text-slate-500' %> uppercase tracking-wider whitespace-nowrap">공지 발송 시 모든 참가자들에게 즉시 알림이 전송됩니다.</p>
  </div>

  <div class="pt-2 md:pt-4">
    <button type="submit" class="w-full py-4 md:py-5 <%= is_prototype ? 'bg-indigo-600 shadow-2xl shadow-indigo-600/40 hover:bg-indigo-500 active:scale-95' : 'bg-indigo-600 shadow-xl hover:bg-indigo-700' %> text-white rounded-2xl md:rounded-[24px] font-black text-sm md:text-base transition-all cursor-pointer">
      <%= announcement.persisted? ? "공지 수정하기" : "공지 발송하기" %>
    </button>
  </div>
<% end %>
