# Secrets defined here are available for reference under registry/password, env/secret, builder/secrets,
# and accessories/*/env/secret in config/deploy.yml. All secrets should be pulled from either
# password manager, ENV, or a file. DO NOT ENTER RAW CREDENTIALS HERE! This file needs to be safe for git.

# For GitHub Actions CI/CD: secrets are passed via environment variables
# For local development: fall back to local files/commands

# GitHub Container Registry password (GitHub PAT with write:packages permission)
if [ -n "$KAMAL_REGISTRY_PASSWORD" ]; then
  KAMAL_REGISTRY_PASSWORD=$KAMAL_REGISTRY_PASSWORD
else
  # Local: use gh CLI to get token
  KAMAL_REGISTRY_PASSWORD=$(gh auth token 2>/dev/null || echo "")
fi

# Rails master key
if [ -n "$RAILS_MASTER_KEY" ]; then
  RAILS_MASTER_KEY=$RAILS_MASTER_KEY
else
  # Local: read from file
  RAILS_MASTER_KEY=$(cat config/master.key 2>/dev/null || echo "")
fi
