<% parent = challenge || routine_club %>
<% is_prototype = params[:source] == "prototype" %>

<%= form_with model: [parent, announcement], local: true, 
              class: "#{is_prototype ? 'app-glass-card p-6 md:p-10 lg:p-12 space-y-8 md:space-y-10 border-none' : 'bg-white rounded-[40px] border border-slate-200 p-10 shadow-sm space-y-8'}",
              data: { controller: "announcement-form" } do |f| %>
  <%= hidden_field_tag :source, "prototype" if is_prototype %>
  
  <% if announcement.errors.any? %>
    <div class="p-6 bg-rose-500/10 rounded-2xl border border-rose-500/20">
      <p class="text-xs font-black text-rose-500 uppercase tracking-widest leading-loose">
        <%= announcement.errors.full_messages.join(". ") %>
      </p>
    </div>
  <% end %>

  <div class="space-y-8 md:space-y-10">
    <div class="space-y-3 md:space-y-4">
      <label class="text-[9px] md:text-[10px] font-black <%= is_prototype ? 'text-slate-500' : 'text-slate-400' %> uppercase tracking-widest pl-1">공지 제목 <span class="text-rose-500">*</span></label>
      <%= f.text_field :title, 
                       placeholder: "공지사항 제목을 입력하세요", 
                       required: true,
                       class: "w-full #{is_prototype ? 'bg-white/5 border-white/10 text-white font-black italic text-lg md:text-xl focus:border-indigo-500' : 'bg-slate-50 border-none text-lg font-bold focus:ring-2 focus:ring-indigo-500'} rounded-[20px] md:rounded-[24px] p-4 md:p-6 outline-none transition-all" %>
    </div>

    <div class="space-y-3 md:space-y-4">
      <label class="text-[9px] md:text-[10px] font-black <%= is_prototype ? 'text-slate-500' : 'text-slate-400' %> uppercase tracking-widest pl-1">공지 내용</label>
      <%= f.text_area :content, 
                       placeholder: "전달할 상세 내용을 입력하세요...", 
                       rows: 8, 
                       class: "w-full #{is_prototype ? 'bg-white/5 border-white/10 text-slate-300 font-medium focus:border-indigo-500' : 'bg-slate-50 border-none text-slate-600 font-medium focus:ring-2 focus:ring-indigo-500'} rounded-[24px] md:rounded-[28px] p-6 md:p-8 outline-none transition-all" %>
    </div>
  </div>

  <div class="p-5 md:p-8 <%= is_prototype ? 'bg-white/5 border-white/5' : 'bg-slate-50 border-slate-100' %> rounded-[24px] md:rounded-[32px] border flex items-start gap-3 md:gap-4">
    <div class="w-7 h-7 md:w-8 md:h-8 rounded-xl <%= is_prototype ? 'bg-indigo-500/20 text-indigo-400' : 'bg-indigo-100 text-indigo-600' %> flex items-center justify-center flex-shrink-0">
      <svg class="w-3.5 h-3.5 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
    </div>
    <p class="text-[10px] md:text-xs font-bold <%= is_prototype ? 'text-slate-400' : 'text-slate-500' %> leading-relaxed uppercase tracking-wider">
      공지사항 발송 시 모든 참가자들에게 알림이 전송됩니다.
    </p>
  </div>

  <div class="pt-4 md:pt-6">
    <button type="submit" class="w-full py-5 md:py-6 <%= is_prototype ? 'bg-indigo-600 shadow-2xl shadow-indigo-600/40 hover:bg-indigo-500 hover:-translate-y-1' : 'bg-indigo-600 shadow-xl hover:bg-indigo-700' %> text-white rounded-[28px] md:rounded-[32px] font-black text-lg md:text-xl transition-all cursor-pointer">
      <%= announcement.persisted? ? "공지 수정하기" : "공지 발송하기" %>
    </button>
  </div>
<% end %>
