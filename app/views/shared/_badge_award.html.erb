<% if @unviewed_badges.any? %>
  <div id="badge-award-overlay" 
       data-controller="badge-award" 
       data-badge-award-badge-ids="<%= @unviewed_badges.map(&:id).to_json %>"
       data-action="click->badge-award#handleBackdropClick"
       class="fixed inset-0 z-[60000] flex items-center justify-center p-6 bg-[#0C0B12]/95 backdrop-blur-2xl transition-all duration-500">
    
    <% @unviewed_badges.each_with_index do |ub, index| %>
      <div data-badge-award-target="container"
           data-action="click->badge-award#preventClosing"
           class="absolute w-full max-w-sm bg-white/5 border border-white/10 rounded-[40px] p-10 text-center shadow-[0_32px_64px_-16px_rgba(0,0,0,0.5)] transform transition-all duration-500 ease-out <%= index == 0 ? 'opacity-100 scale-100' : 'opacity-0 scale-90 pointer-events-none' %>"
           style="z-index: <%= 100 - index %>;">
        
        <!-- Decoration -->
        <div class="absolute -top-24 -right-24 w-48 h-48 bg-indigo-500/10 blur-[80px] rounded-full"></div>

        <div class="relative space-y-8">
          <!-- Icon Badge -->
          <div class="inline-flex items-center justify-center w-24 h-24 bg-gradient-to-br from-indigo-500/20 to-purple-600/20 rounded-[32px] text-5xl shadow-inner border border-white/10 animate-badge-pop">
            <%= ub.badge.icon_path %>
          </div>

          <!-- Text Info -->
          <div class="space-y-3">
            <p class="text-[10px] font-black text-indigo-400 uppercase tracking-[0.2em] animate-in fade-in slide-in-from-bottom-2 duration-700">New Achievement Unlocked</p>
            <h3 class="text-3xl font-black text-white tracking-tight leading-tight animate-in fade-in slide-in-from-bottom-3 duration-700 delay-100"><%= ub.badge.name %></h3>
            <p class="text-slate-400 font-bold text-sm leading-relaxed animate-in fade-in slide-in-from-bottom-4 duration-700 delay-200"><%= ub.badge.description %></p>
          </div>

          <!-- Single Action Button -->
          <div class="pt-4 animate-in fade-in slide-in-from-bottom-5 duration-700 delay-300">
            <button data-action="click->badge-award#next" 
                    class="w-full bg-white text-[#0C0B12] py-5 rounded-2xl font-black text-base hover:scale-[1.02] active:scale-[0.98] transition-all shadow-xl shadow-white/5">
              확인했어요
            </button>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>

<style>
  @keyframes radial-gradient {
    0% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.5); opacity: 0.2; }
    100% { transform: scale(1); opacity: 0.5; }
  }
</style>
