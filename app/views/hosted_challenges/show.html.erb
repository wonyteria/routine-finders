<div class="space-y-8 pb-32">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <%= link_to hosted_challenges_path, class: "p-3 bg-white border border-slate-200 rounded-2xl text-slate-500 hover:text-indigo-600 shadow-sm transition-all" do %>
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/></svg>
    <% end %>
    <div class="flex items-center gap-3">
      <%= link_to challenge_path(@challenge), class: "px-5 py-2 bg-slate-100 text-slate-700 rounded-xl font-bold text-sm hover:bg-slate-200 transition-all" do %>
        공개 페이지 보기
      <% end %>
    </div>
  </div>

  <!-- Challenge Info Header -->
  <div class="bg-white rounded-[40px] border border-slate-200 shadow-sm overflow-hidden">
    <div class="flex items-center gap-6 p-8">
      <img src="<%= @challenge.thumbnail %>" class="w-24 h-24 rounded-3xl object-cover" alt="">
      <div class="flex-1">
        <div class="flex items-center gap-2 mb-2">
          <span class="px-3 py-1 rounded-full text-[10px] font-black uppercase <%= @challenge.offline? ? 'bg-orange-100 text-orange-700' : 'bg-indigo-100 text-indigo-700' %>">
            <%= @challenge.offline? ? 'OFFLINE' : 'ONLINE' %>
          </span>
          <% if @challenge.requires_approval? %>
            <span class="px-3 py-1 rounded-full text-[10px] font-black uppercase bg-amber-100 text-amber-700">승인제</span>
          <% end %>
        </div>
        <h1 class="text-2xl font-black text-slate-900"><%= @challenge.title %></h1>
        <p class="text-slate-500 mt-1"><%= @challenge.start_date.strftime('%Y.%m.%d') %> ~ <%= @challenge.end_date.strftime('%Y.%m.%d') %></p>
      </div>
    </div>

    <!-- Stats Grid -->
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 border-t border-slate-200">
      <div class="p-6 text-center border-r border-slate-200">
        <p class="text-3xl font-black text-indigo-600"><%= @stats[:total_participants] %></p>
        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">총 참가자</p>
      </div>
      <div class="p-6 text-center border-r border-slate-200">
        <div class="flex items-center justify-center gap-2">
          <p class="text-2xl font-black text-green-600"><%= @stats[:active_today] %></p>
          <span class="text-slate-300">/</span>
          <p class="text-2xl font-black text-slate-400"><%= @stats[:unverified_today] %></p>
        </div>
        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">오늘 완료/미완료</p>
      </div>
      <div class="p-6 text-center border-r border-slate-200">
        <p class="text-3xl font-black text-slate-900"><%= @stats[:avg_completion_rate] %>%</p>
        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">평균 달성률</p>
      </div>
      <div class="p-6 text-center border-r border-slate-200">
        <p class="text-3xl font-black text-orange-500"><%= @stats[:streak_keepers] %></p>
        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">스트릭 유지</p>
      </div>
      <div class="p-6 text-center border-r border-slate-200">
        <p class="text-3xl font-black text-red-600"><%= @stats[:dropped_out] %></p>
        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">탈락 인원</p>
      </div>
      <div class="p-6 text-center">
        <p class="text-3xl font-black <%= @stats[:pending_verifications] > 0 ? 'text-amber-600' : 'text-slate-300' %>"><%= @stats[:pending_verifications] %></p>
        <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">인증 대기</p>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="border-t border-slate-200">
      <nav class="flex gap-0 px-8">
        <%= link_to hosted_challenge_path(@challenge, tab: "dashboard"), class: "px-6 py-4 font-bold text-sm border-b-2 transition-all #{@tab == 'dashboard' ? 'border-indigo-600 text-indigo-600' : 'border-transparent text-slate-400 hover:text-slate-600'}" do %>
          대시보드
        <% end %>
        <% if @challenge.requires_approval? %>
          <%= link_to hosted_challenge_path(@challenge, tab: "applications"), class: "px-6 py-4 font-bold text-sm border-b-2 transition-all #{@tab == 'applications' ? 'border-indigo-600 text-indigo-600' : 'border-transparent text-slate-400 hover:text-slate-600'}" do %>
            신청 관리
            <% if @stats[:pending_applications] > 0 %>
              <span class="ml-2 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full"><%= @stats[:pending_applications] %></span>
            <% end %>
          <% end %>
        <% end %>
        <%= link_to hosted_challenge_path(@challenge, tab: "participants"), class: "px-6 py-4 font-bold text-sm border-b-2 transition-all #{@tab == 'participants' ? 'border-indigo-600 text-indigo-600' : 'border-transparent text-slate-400 hover:text-slate-600'}" do %>
          참가자
        <% end %>
        <%= link_to hosted_challenge_path(@challenge, tab: "announcements"), class: "px-6 py-4 font-bold text-sm border-b-2 transition-all #{@tab == 'announcements' ? 'border-indigo-600 text-indigo-600' : 'border-transparent text-slate-400 hover:text-slate-600'}" do %>
          공지사항
        <% end %>
        <%= link_to hosted_challenge_path(@challenge, tab: "reviews"), class: "px-6 py-4 font-bold text-sm border-b-2 transition-all #{@tab == 'reviews' ? 'border-indigo-600 text-indigo-600' : 'border-transparent text-slate-400 hover:text-slate-600'}" do %>
          리뷰
        <% end %>
      </nav>
    </div>
  </div>

  <!-- Tab Content -->
  <div>
    <% case @tab %>
    <% when "dashboard" %>
      <%= render "hosted_challenges/tabs/dashboard", challenge: @challenge, participants: @participants, pending_verifications: @pending_verifications, recent_verifications: @recent_verifications %>
    <% when "applications" %>
      <%= render "hosted_challenges/tabs/applications", challenge: @challenge, pending_applications: @pending_applications, processed_applications: @processed_applications %>
    <% when "participants" %>
      <%= render "hosted_challenges/tabs/participants", challenge: @challenge, participants: @participants %>
    <% when "announcements" %>
      <%= render "hosted_challenges/tabs/announcements", challenge: @challenge, announcements: @announcements %>
    <% when "reviews" %>
      <%= render "hosted_challenges/tabs/reviews", challenge: @challenge, reviews: @reviews %>
    <% end %>
  </div>
</div>
