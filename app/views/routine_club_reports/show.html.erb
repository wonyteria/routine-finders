<%# PROTOTYPE STYLE: Routine Club Report Detail %>
<div class="flex flex-col bg-[#0C0B12] text-white min-h-screen relative -mx-4 -mt-8 pb-32">
  <!-- 1. Header (Sticky) -->
  <header class="sticky top-0 z-50 px-6 py-5 bg-[#0C0B12]/80 backdrop-blur-md flex items-center gap-4">
    <% back_path = params[:source] == 'admin' ? prototype_member_reports_path(user_id: @report.user_id) : routine_club_reports_path %>
    <%= link_to back_path, class: "w-10 h-10 -ml-2 rounded-full flex items-center justify-center text-slate-400 active:scale-95 transition-all hover:bg-white/5" do %>
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7"/></svg>
    <% end %>
    <div>
      <h1 class="text-xl font-black text-white leading-none">
        <%= @report.start_date.strftime("%B") %> <span class="italic text-indigo-400">Rufa Report</span>
      </h1>
      <p class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-0.5">Monthly Growth Analysis</p>
    </div>
  </header>

  <div class="px-6 space-y-8 mt-2">
    <!-- 2. Identity Card -->
    <section class="app-glass-card p-8 border-white/5 relative overflow-hidden text-center space-y-6">
      <div class="absolute -right-12 -top-12 w-40 h-40 bg-indigo-500/20 rounded-full blur-3xl"></div>
      <div class="absolute -left-12 -bottom-12 w-40 h-40 bg-purple-500/20 rounded-full blur-3xl"></div>

      <div class="relative z-10">
        <div class="w-24 h-24 mx-auto rounded-[2rem] bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-5xl shadow-[0_10px_30px_rgba(99,102,241,0.3)] ring-4 ring-white/5 mb-6">
          <%= case @report.identity_title
              when /ë§ˆìŠ¤í„°/ then "ğŸ‘‘"
              when /ê°€ì´ë“œ/ then "ğŸ§­"
              when /ê°œì²™ì/ then "âš”ï¸"
              else "ğŸŒ±"
              end %>
        </div>
        
        <div class="space-y-2">
          <p class="text-[10px] font-black text-indigo-400 uppercase tracking-[0.2em]">Your Identity</p>
          <h2 class="text-3xl font-black text-white italic tracking-tight">"<%= @report.identity_title %>"</h2>
        </div>
        
        <div class="h-1 w-16 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full mx-auto mt-6"></div>
      </div>
    </section>

    <!-- 3. Key Metrics (Grid) -->
    <section class="grid grid-cols-2 gap-4">
      <!-- Log Rate -->
      <div class="app-glass-card p-5 border-white/5 flex flex-col justify-between h-32 relative overflow-hidden">
        <div class="relative z-10">
          <span class="text-[9px] font-black text-slate-500 uppercase tracking-wider block mb-2">Log Rate</span>
          <div class="flex items-baseline gap-1">
            <span class="text-3xl font-black text-white"><%= @report.log_rate.to_i %></span>
            <span class="text-sm font-bold text-slate-500">%</span>
          </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="w-full h-1.5 bg-white/5 rounded-full overflow-hidden">
          <div class="h-full bg-slate-200 rounded-full" style="width: <%= @report.log_rate %>%"></div>
        </div>
      </div>

      <!-- Achievement Rate -->
      <div class="app-glass-card p-5 border-indigo-500/30 bg-indigo-500/10 flex flex-col justify-between h-32 relative overflow-hidden shadow-[0_0_20px_rgba(99,102,241,0.1)]">
        <div class="absolute inset-0 bg-gradient-to-br from-indigo-500/10 to-transparent"></div>
        <div class="relative z-10">
          <span class="text-[9px] font-black text-indigo-300 uppercase tracking-wider block mb-2">Achievement</span>
          <div class="flex items-baseline gap-1">
            <span class="text-3xl font-black text-indigo-400"><%= @report.achievement_rate.to_i %></span>
            <span class="text-sm font-bold text-indigo-500/70">%</span>
          </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="w-full h-1.5 bg-black/20 rounded-full overflow-hidden">
          <div class="h-full bg-indigo-400 rounded-full shadow-[0_0_10px_rgba(99,102,241,0.5)]" style="width: <%= @report.achievement_rate %>%"></div>
        </div>
      </div>
    </section>

    <!-- 4. Summary & Cheering -->
    <section class="space-y-4">
      <div class="flex items-center gap-2 px-1">
         <span class="text-lg">ğŸ“</span>
         <h3 class="text-sm font-black text-white italic">Summary & Cheering</h3>
      </div>
      
      <div class="app-glass-card p-6 border-white/5 space-y-6">
        <p class="text-sm font-medium text-slate-300 leading-relaxed">
          <%= @report.summary %>
        </p>
        
        <div class="pl-4 border-l-2 border-indigo-500/50">
          <p class="text-xs font-bold text-indigo-300 italic">
            "<%= @report.cheering_message %>"
          </p>
        </div>
      </div>
    </section>

    <!-- 5. Goal Review -->
    <section class="space-y-4">
      <div class="flex items-center gap-2 px-1">
         <span class="text-lg">ğŸ¯</span>
         <h3 class="text-sm font-black text-white italic">Goal Review</h3>
      </div>
      
      <div class="app-glass-card p-6 border-white/5 space-y-6">
        <% 
          user_goals = @report.user.user_goals.index_by(&:goal_type)
          [[:long_term, "Long Term", "bg-purple-500"], [:mid_term, "Mid Term", "bg-indigo-500"], [:short_term, "Short Term", "bg-emerald-500"]].each do |key, label, color|
            goal_body = user_goals[key.to_s]&.body
        %>
          <div class="relative pl-6">
             <div class="absolute left-0 top-1.5 w-2 h-2 rounded-full <%= color %> shadow-[0_0_8px_currentColor]"></div>
             <p class="text-[9px] font-black text-slate-500 uppercase tracking-widest mb-1"><%= label %></p>
             <p class="text-sm font-bold text-slate-200 <%= 'line-through opacity-40 decoration-emerald-500 decoration-2' if @report.achievement_rate >= 90 && key == :short_term %>">
               <%= goal_body.present? ? goal_body : "ì„¤ì •ëœ ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤." %>
             </p>
          </div>
        <% end %>
      </div>
    </section>

    <!-- 6. Actions -->
    <div class="pt-8 text-center pb-8">
      <p class="text-[10px] text-slate-600 mb-6">
        ì´ ë¦¬í¬íŠ¸ëŠ” ë£¨í‹´ íŒŒì¸ë”ìŠ¤ì—ì„œì˜<br/>ì†Œì¤‘í•œ ì„±ì¥ ê¸°ë¡ì…ë‹ˆë‹¤.
      </p>
      <%= link_to routine_club_reports_path, class: "glass-btn py-4 w-full flex items-center justify-center text-sm font-bold text-slate-300 hover:text-white" do %>
         ë‹«ê¸°
      <% end %>
    </div>
  </div>
</div>
