<div class="h-[calc(100vh-100px)] flex flex-col pt-2 bg-[#0C0B12] overflow-hidden select-none relative">
  <style>
    .app-stat-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 2rem;
    }
    .app-user-card {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 2.5rem;
      transition: all 0.3s ease;
    }
    .app-user-card:hover {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(99, 102, 241, 0.2);
    }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
  </style>

  <!-- Header -->
  <header class="flex items-center justify-between mb-6 px-8 shrink-0 z-20">
    <%= link_to challenge_path(@challenge, source: 'prototype'), class: "w-10 h-10 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-slate-400 active:scale-90 transition-all font-black" do %>
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"/></svg>
    <% end %>
    <div class="text-center">
      <h1 class="text-base font-black text-white">ì‹ ì²­ ë‚´ì—­ ê´€ë¦¬</h1>
      <p class="text-[9px] font-bold text-slate-500 mt-0.5"><%= @challenge.title %></p>
    </div>
    <div class="w-10"></div>
  </header>

  <div class="flex-1 overflow-y-auto hide-scrollbar px-8 pb-32 space-y-8 z-10">
    <!-- Stats Summary -->
    <div class="grid grid-cols-3 gap-3">
      <div class="app-stat-card p-5 text-center">
        <p class="text-2xl font-black text-amber-500 tabular-nums"><%= @pending_applications.count %></p>
        <p class="text-[8px] font-black text-slate-600 uppercase tracking-widest mt-1">Pending</p>
      </div>
      <div class="app-stat-card p-5 text-center border-emerald-500/10 bg-emerald-500/[0.02]">
        <p class="text-2xl font-black text-emerald-500 tabular-nums"><%= @applications.approved.count %></p>
        <p class="text-[8px] font-black text-slate-600 uppercase tracking-widest mt-1">Approved</p>
      </div>
      <div class="app-stat-card p-5 text-center">
        <p class="text-2xl font-black text-slate-400 tabular-nums"><%= @applications.rejected.count %></p>
        <p class="text-[8px] font-black text-slate-600 uppercase tracking-widest mt-1">Rejected</p>
      </div>
    </div>

    <!-- Pending List -->
    <div class="space-y-4">
      <div class="flex items-center gap-2 px-1">
        <div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div>
        <h2 class="text-xs font-black text-white uppercase tracking-widest">ìŠ¹ì¸ ëŒ€ê¸° ì¤‘</h2>
      </div>

      <% if @pending_applications.any? %>
        <div class="space-y-4">
          <% @pending_applications.each do |app| %>
            <div class="app-user-card p-6 space-y-5">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                  <img src="<%= app.user.profile_image %>" class="w-12 h-12 rounded-[1.25rem] object-cover bg-white/5 border border-white/5">
                  <div>
                    <p class="text-sm font-black text-white"><%= app.user.nickname %></p>
                    <p class="text-[9px] font-bold text-slate-500 mt-0.5"><%= time_ago_in_words(app.applied_at) %>ì „ ì‹ ì²­</p>
                  </div>
                </div>
                <div class="flex gap-2">
                  <%= button_to approve_challenge_application_path(@challenge, app, source: 'prototype'), method: :post, class: "w-10 h-10 rounded-xl bg-indigo-500 text-white flex items-center justify-center active:scale-90 transition-all shadow-lg shadow-indigo-500/20" do %>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg>
                  <% end %>
                  <%= button_to reject_challenge_application_path(@challenge, app, source: 'prototype'), method: :post, class: "w-10 h-10 rounded-xl bg-white/5 border border-white/10 text-slate-500 flex items-center justify-center active:scale-90 transition-all" do %>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12"/></svg>
                  <% end %>
                </div>
              </div>

              <% if app.message.present? %>
                <div class="p-4 rounded-2xl bg-white/5 border border-white/5">
                  <p class="text-[9px] font-black text-slate-600 uppercase tracking-widest mb-2">Message</p>
                  <p class="text-[11px] font-bold text-slate-300 leading-relaxed italic">"<%= app.message %>"</p>
                </div>
              <% end %>

              <div class="flex gap-2">
                 <% if app.depositor_name.present? %>
                   <span class="px-2.5 py-1 rounded-md bg-indigo-500/10 text-indigo-400 text-[9px] font-black border border-indigo-500/10">ğŸ’° <%= app.depositor_name %></span>
                 <% end %>
                 <% if app.contact_info.present? %>
                   <span class="px-2.5 py-1 rounded-md bg-emerald-500/10 text-emerald-400 text-[9px] font-black border border-emerald-500/10">ğŸ“ CONTACT</span>
                 <% end %>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="py-12 text-center app-user-card border-dashed">
           <p class="text-[10px] font-bold text-slate-600 uppercase tracking-widest">ìƒˆë¡œìš´ ì‹ ì²­ì´ ì—†ìŠµë‹ˆë‹¤</p>
        </div>
      <% end %>
    </div>

    <!-- Processed List -->
    <% if @processed_applications.any? %>
      <div class="space-y-4">
        <div class="flex items-center gap-2 px-1">
          <div class="w-1.5 h-1.5 rounded-full bg-slate-700"></div>
          <h2 class="text-xs font-black text-slate-500 uppercase tracking-widest">ì²˜ë¦¬ ì™„ë£Œ</h2>
        </div>
        <div class="space-y-3">
          <% @processed_applications.each do |app| %>
            <div class="app-user-card p-4 flex items-center justify-between opacity-60 grayscale-[0.5]">
              <div class="flex items-center gap-3">
                <img src="<%= app.user.profile_image %>" class="w-8 h-8 rounded-lg object-cover grayscale">
                <p class="text-xs font-black text-white"><%= app.user.nickname %></p>
              </div>
              <div>
                <% if app.approved? %>
                  <span class="px-2 py-1 rounded bg-emerald-500/10 text-emerald-500 text-[8px] font-black uppercase tracking-tighter">Approved</span>
                <% else %>
                  <span class="px-2 py-1 rounded bg-white/5 text-slate-500 text-[8px] font-black uppercase tracking-tighter">Rejected</span>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Decoration -->
  <div class="absolute -bottom-24 -left-24 w-64 h-64 bg-indigo-500/10 blur-[100px] pointer-events-none"></div>
</div>
